#Upstart service for term.world node application
#Copy this to /etc/init/termworld.conf
#It will start on reboot

description "Term.world node js application"
author "Koen van Gilst"

start on filesystem or runlevel [2345]
stop on shutdown

# Respawn in case of a crash, with default parameters
respawn

script

    export HOME=/opt/term.world/
    echo $$ > /var/run/nodetest.pid
    export NODE_ENV="production"
    export PORT=80
    exec /usr/local/bin/node /opt/term.world/server.js >> /root/termworld.log

end script

pre-start script
    echo "[`date`] Node Server Starting" >> /root/termworld-upstart.log
end script

pre-stop script
    rm /var/run/nodetest.pid
    echo "[`date`] Node Server Stopping" >> /root/termworld-upstart.log
end script
